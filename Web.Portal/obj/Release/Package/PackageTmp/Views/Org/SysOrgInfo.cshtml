@model ICusCRM.Application.SystemMgtServices.Dtos.TenantItem

<div class="row">
    <div class="tabs-container">
        <ul class="nav nav-tabs">
            <li class="active">
                <a data-toggle="tab" href="#tab-1" aria-expanded="false">基本信息</a>
            </li>
            @*<li class="">
                    <a data-toggle="tab" href="#tab-2" aria-expanded="true">账号设置</a>
                </li>*@
            <li class="">
                <a data-toggle="tab" href="#tab-3" aria-expanded="true">配置信息</a>
            </li>
        </ul>
        <div class="tab-content">
            <input type="hidden" name="isAdmin" value="" />
            <div id="tab-1" class="tab-pane  active">
                <div class="panel-body">
                    <form class="form-horizontal" novalidate="novalidate">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">机构账号：</label>
                            <div class="col-sm-5">
                                <label class=" control-label">@Model.NetSysUserAccount</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">机构昵称：</label>
                            <div class="col-sm-5">
                                <label class=" control-label">@Model.NetSysUserName</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">所属角色：</label>
                            <div class="col-sm-5">
                                <label class=" control-label">@Model.NetSysUserNetSysRoleName</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">通信密钥：</label>
                            <div class="col-sm-5">
                                <label id="AesKey" class="control-label">@Model.AesKey</label>
                                <label class=" control-label"><a onclick="update()" class="btn btn-info btn-xs" href="#">更新</a></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">通信网关：</label>
                            <div class="col-sm-5">
                                <label class=" control-label">@Model.Gateway</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">备注信息：</label>
                            <div class="col-sm-5">
                                <label class="control-label">@Model.Descriptions</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">其他信息：</label>
                            <div class="col-sm-2">
                                <div class="col-sm-7">
                                    <img width="150" src="@Model.Logo" alt="机构Logo.jpg" class="img-rounded">
                                </div>
                                <label class="col-sm-6 control-label">机构Logo</label>
                            </div>
                            <div class="col-sm-2">
                                <div class="col-sm-7">
                                    <img width="150" src="@Model.FrontImage" alt="机构Ico.jpg" class="img-rounded">
                                </div>
                                <label class="col-sm-6 control-label">机构Ico</label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div id="tab-2" class="tab-pane">
                <div class="panel-body">
                    <form class="form-horizontal" novalidate="novalidate">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">原始密码：</label>
                            <div class="col-sm-5">
                                <input id="oldPwd" name="oldPwd" class="form-control" value="" type="password" aria-required="true" aria-invalid="false"><span class="help-block m-b-none"><i class="fa fa-info-circle"></i> 系统默认初始化密码是123456，请尽快更改。</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">新密码：</label>
                            <div class="col-sm-5">
                                <input id="newPwd" name="newPwd" class="form-control" type="password" aria-required="true" value="" aria-invalid="false">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">重复密码：</label>
                            <div class="col-sm-5">
                                <input id="newPwd2" name="newPwd2" class="form-control" type="password" value="" aria-required="true" aria-invalid="false">
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 25px">
                            <div class="col-sm-10" style="text-align:center;">
                                <button type="button" onclick="SavePwd(oldPwd.value, newPwd.value, newPwd2.value)" class="btn btn-primary">保存</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div id="tab-3" class="tab-pane">
                <div class="panel-body">
                    <form class="form-horizontal" novalidate="novalidate">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">服务器白名单一：</label>
                            <div class="col-sm-5">
                                @if (Model.NetTenantIpWhites.Count > 0 && Model.NetTenantIpWhites[0] != null)
                                {
                                    <input id="One" name="One" class="form-control" value="@Model.NetTenantIpWhites[0].IpAddress" type="text" aria-required="true" aria-invalid="false">
                                }
                                else
                                {
                                    <input id="One" name="One" class="form-control" value="" type="text" aria-required="true" aria-invalid="false">
                                }

                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">服务器白名单二：</label>
                            <div class="col-sm-5">
                                @if (Model.NetTenantIpWhites.Count > 1 && Model.NetTenantIpWhites[1] != null)
                                {
                                    <input id="Two" name="Two" class="form-control" value="@Model.NetTenantIpWhites[1].IpAddress" type="text" aria-required="true" aria-invalid="false">
                                }
                                else
                                {
                                    <input id="Two" name="Two" class="form-control" value="" type="text" aria-required="true" aria-invalid="false">
                                }
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">服务器白名单三：</label>
                            <div class="col-sm-5">
                                @if (Model.NetTenantIpWhites.Count > 2 && Model.NetTenantIpWhites[2] != null)
                                {
                                    <input id="Three" name="Three" class="form-control" value="@Model.NetTenantIpWhites[2].IpAddress" type="text" aria-required="true" aria-invalid="false">
                                }
                                else
                                {
                                    <input id="Three" name="Three" class="form-control" value="" type="text" aria-required="true" aria-invalid="false">
                                }
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">接口回调地址：</label>
                            <div class="col-sm-5">
                                <input id="TokenUrl" name="TokenUrl" class="form-control" value="@Model.TokenUrl" type="text" aria-required="true" aria-invalid="false">
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 25px">
                            <div class="col-sm-10" style="text-align:center;">
                                <button type="button" onclick="SaveIpWhite(One.value, Two.value, Three.value, TokenUrl.value)" class="btn btn-primary">保存</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


@section js{
    <script>

        new Vue({ el: 'body' });

        // 添加白名单
        function SaveIpWhite(one, two, three, tokenUrl) {
            $.post('@Url.Action("SaveIpWhite")', { 'one': one, 'two': two, 'three': three, 'tokenUrl': tokenUrl }, function () {
                ICusCRM.Msg.showSuccess();
            });
        }

        // 重置密码
        function update() {
            $.post('@Url.Action("updateAesKey")', {}, function (str) {
                $("#AesKey").html(str);
                ICusCRM.Msg.showSuccess();
            });
        }
    </script>
}


